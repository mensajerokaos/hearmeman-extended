{
  "last_node_id": 8,
  "last_link_id": 10,
  "nodes": [
    {
      "id": 1,
      "type": "LoadImage",
      "pos": [50, 100],
      "size": [315, 314],
      "inputs": [],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [1, 4]},
        {"name": "MASK", "type": "MASK", "links": null}
      ],
      "properties": {},
      "widgets_values": ["example.png", "image"]
    },
    {
      "id": 2,
      "type": "GenfocusDeblurNetLoader",
      "pos": [50, 450],
      "size": [315, 126],
      "inputs": [],
      "outputs": [
        {"name": "GENFOCUS_DEBLUR", "type": "GENFOCUS_DEBLUR", "links": [2]}
      ],
      "properties": {},
      "widgets_values": ["deblurNet.safetensors", "auto", "cuda", false]
    },
    {
      "id": 3,
      "type": "GenfocusBokehNetLoader",
      "pos": [50, 620],
      "size": [315, 126],
      "inputs": [],
      "outputs": [
        {"name": "GENFOCUS_BOKEH", "type": "GENFOCUS_BOKEH", "links": [3]}
      ],
      "properties": {},
      "widgets_values": ["bokehNet.safetensors", "auto", "cuda", false]
    },
    {
      "id": 4,
      "type": "GenfocusDeblur",
      "pos": [450, 100],
      "size": [350, 200],
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 1},
        {"name": "model", "type": "GENFOCUS_DEBLUR", "link": 2}
      ],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [5]}
      ],
      "properties": {},
      "widgets_values": [30, 7.5, "", 0]
    },
    {
      "id": 5,
      "type": "GenfocusBokeh",
      "pos": [450, 350],
      "size": [350, 280],
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 5},
        {"name": "model", "type": "GENFOCUS_BOKEH", "link": 3},
        {"name": "depth_map", "type": "DEPTH_MAP", "link": null}
      ],
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [6]}
      ],
      "properties": {},
      "widgets_values": [30, 7.5, 0.5, 0.7, "circle", 0]
    },
    {
      "id": 6,
      "type": "PreviewImage",
      "pos": [850, 100],
      "size": [300, 300],
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 4}
      ],
      "properties": {},
      "widgets_values": []
    },
    {
      "id": 7,
      "type": "PreviewImage",
      "pos": [850, 450],
      "size": [300, 300],
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 6}
      ],
      "properties": {},
      "widgets_values": []
    },
    {
      "id": 8,
      "type": "SaveImage",
      "pos": [1200, 350],
      "size": [315, 270],
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 6}
      ],
      "outputs": [],
      "properties": {},
      "widgets_values": ["genfocus-refocused"]
    }
  ],
  "links": [
    [1, 1, 0, 4, 0, "IMAGE"],
    [2, 2, 0, 4, 1, "GENFOCUS_DEBLUR"],
    [3, 3, 0, 5, 1, "GENFOCUS_BOKEH"],
    [4, 1, 0, 6, 0, "IMAGE"],
    [5, 4, 0, 5, 0, "IMAGE"],
    [6, 5, 0, 7, 0, "IMAGE"],
    [6, 5, 0, 8, 0, "IMAGE"]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.9,
      "offset": [0, 0]
    }
  },
  "version": 0.4,
  "_metadata": {
    "name": "Genfocus Refocusing",
    "description": "Two-stage refocusing: DeblurNet recovers sharp image, BokehNet adds depth-of-field",
    "models_required": [
      {"name": "deblurNet.safetensors", "path": "genfocus/", "source": "HuggingFace nycu-cplab/Genfocus-Model"},
      {"name": "bokehNet.safetensors", "path": "genfocus/", "source": "HuggingFace nycu-cplab/Genfocus-Model"},
      {"name": "depth_pro.pt", "path": "genfocus/", "source": "HuggingFace nycu-cplab/Genfocus-Model"}
    ],
    "settings": {
      "steps": 30,
      "guidance_scale": 7.5,
      "focus_distance": "0.5 (middle depth)",
      "bokeh_intensity": "0.7 (strong blur)"
    },
    "notes": "Adjust focus_distance (0=near, 1=far) and bokeh_intensity (0-1) to control depth-of-field effect. Circle aperture is most natural, try heart/star for creative effects."
  }
}
